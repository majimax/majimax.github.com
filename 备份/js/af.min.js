var afTurn=(function(){
var _1=true;
function _2(_3,_4,_5){
af.asDefault(_4,"effect","default");
af.asDefault(_4,"ease","linear");
var _6=_4.effect;
var _7=_8(_4.ease);
var _9=_3.scene;
var _a=_4.target;
if(_4.direction=="top"){
_b(_9,_a,_6,_7,_5);
}else{
_c(_9,_a,_6,_7,_5);
}
};
function _8(_d){
var _e=createjs.Ease;
var _f=[{type:_e.backIn,label:"backIn"},{type:_e.backInOut,label:"backInOut"},{type:_e.backOut,label:"backOut"},{type:_e.bounceIn,label:"bounceIn"},{type:_e.bounceInOut,label:"bounceInOut"},{type:_e.bounceOut,label:"bounceOut"},{type:_e.circIn,label:"circIn"},{type:_e.circInOut,label:"circInOut"},{type:_e.circOut,label:"circOut"},{type:_e.cubicIn,label:"cubicIn"},{type:_e.cubicInOut,label:"cubicInOut"},{type:_e.cubicOut,label:"cubicOut"},{type:_e.elasticIn,label:"elasticIn"},{type:_e.elasticInOut,label:"elasticInOut"},{type:_e.elasticOut,label:"elasticOut"},{type:_e.linear,label:"linear"},{type:_e.quadIn,label:"quadIn"},{type:_e.quadInOut,label:"quadInOut"},{type:_e.quadOut,label:"quadOut"},{type:_e.quartIn,label:"quartIn"},{type:_e.quartInOut,label:"quartInOut"},{type:_e.quartOut,label:"quartOut"},{type:_e.quintIn,label:"quintIn"},{type:_e.quintInOut,label:"quintInOut"},{type:_e.quintOut,label:"quintOut"},{type:_e.sineIn,label:"sineIn"},{type:_e.sineInOut,label:"sineInOut"},{type:_e.sineOut,label:"sineOut"}];
for(var i in _f){
if(_f[i].label==_d){
return _f[i].type;
}
}
return _e.linear;
};
function _b(_10,_11,_12,_13,_14){
if(_1==false){
return;
}
if(af.ismode(_10)){
return;
}
_1=false;
var _15=_12;
var _16=_13;
if(_15=="default"){
af.hideScene(_10,true);
af.showScene(_11,true);
_1=true;
_14();
}else{
if(_15=="translation"){
af.showScene(_11,false,"before");
var _17=af.s(_11).element;
_17.x=0;
_17.y=-af.canvas.height;
var _18=af.s(_10).element;
afAction.dispatchOn(_10,"hide");
createjs.Tween.get(_18).to({y:af.canvas.height},1000,_16);
createjs.Tween.get(_17).to({y:0},1000,_16).call(function(){
af.hideScene(_10);
afAction.dispatchOn(_11,"show");
_1=true;
_14();
});
}else{
if(_15=="scanning"){
af.showScene(_11);
var _19=new createjs.Shape();
_19.graphics.beginFill("#0000ff").drawRect(0,0,af.canvas.width,af.canvas.height);
_19.visible=false;
_19.y=-af.canvas.height;
af.stage.addChild(_19);
var _17=af.s(_11).element;
_17.mask=_19;
createjs.Tween.get(_19).to({y:0},1000,_16).call(function(){
_17.mask=null;
af.stage.removeChild(_19);
af.hideScene(_10);
_1=true;
_14();
});
}
}
}
};
function _c(_1a,_1b,_1c,_1d,_1e){
if(_1==false){
return;
}
if(af.ismode(_1a)){
return;
}
_1=false;
var _1f=_1c;
var _20=_1d;
if(_1f=="default"){
af.hideScene(_1a,true);
af.showScene(_1b,true);
_1=true;
_1e();
}else{
if(_1f=="translation"){
af.showScene(_1b);
var _21=af.s(_1b).element;
_21.x=0;
_21.y=af.canvas.height;
var _22=af.s(_1a).element;
afAction.dispatchOn(_1a,"hide");
createjs.Tween.get(_22).to({y:-af.canvas.height},1000,_20);
createjs.Tween.get(_21).to({y:0},1000,_20).call(function(){
af.hideScene(_1a);
afAction.dispatchOn(_1b,"show");
_1=true;
_1e();
});
}else{
if(_1f=="scanning"){
af.showScene(_1b);
var _23=new createjs.Shape();
_23.graphics.beginFill("#0000ff").drawRect(0,0,af.canvas.width,af.canvas.height);
_23.visible=false;
_23.y=af.canvas.height;
af.stage.addChild(_23);
var _21=af.s(_1b).element;
_21.mask=_23;
createjs.Tween.get(_23).to({y:0},1000,_20).call(function(){
_21.mask=null;
af.stage.removeChild(_23);
af.hideScene(_1a);
_1=true;
_1e();
});
}
}
}
};
return {exectue:_2};
})();
var afProgress=(function(){
var _1;
var _2=function(_3){
if(af.m.loading==null||af.m.loading.length<=0){
_1=true;
afDefaultLoading.execute(_3);
}else{
_1=false;
var _4=af.m.loading[0];
afCustormLoading.execute(_4,_3);
}
};
var _5=function(){
if(_1){
afDefaultLoading.progress(10);
}else{
afCustormLoading.progress(10);
}
};
var _6=function(){
if(_1){
afDefaultLoading.progress(20);
}else{
afCustormLoading.progress(20);
}
};
var _7=function(_8){
_8=(_8*0.8+20)>>0;
if(_1){
afDefaultLoading.progress(_8);
}else{
afCustormLoading.progress(_8);
}
};
var _9=function(){
if(_1){
afDefaultLoading.progress(99);
}else{
afCustormLoading.progress(99);
}
};
var _a=function(_b){
setTimeout(function(){
if(_1){
afDefaultLoading.destory();
}else{
afCustormLoading.destory();
}
_b();
},600);
};
return {execute:_2,completeSWF:_5,completePlug:_6,completeImage:_9,completeAf:_a,loadImage:_7};
})();
var afDefaultLoading=(function(){
var _c=function(_d){
$(af.application).append("<div class=\"Bars\"><div class=\"BarsDiv\"></div></div>");
$("*").css({"margin":"0","padding":"0"});
$(".Bars").css({"position":"relative","z-index":"2","width":"100%","border":"0px solid #B1D632"});
$(".BarsDiv").css({"display":"block","position":"relative","background":"#00F","color":"#333333","height":"10px","line-height":"10px","background":"#090","width":"0%","transition":"width 0.5s","-moz-transition":"width 0.5s","-webkit-transition":"width 0.5s","-o-transition":"width 0.5s"});
_d();
};
var _e=function(_f){
$(".BarsDiv").css({"width":_f+"%"});
};
var _10=function(){
$(".Bars").css({"display":"none"});
};
return {execute:_c,progress:_e,destory:_10};
})();
var afCustormLoading=(function(){
var _11;
var _12;
var _13;
var _14;
var _15=function(_16,_17){
_14=_16;
af.asDefault(_14,"namespace","lib");
if(_14.swf){
afJsLoad.load(_14.swf,function(err,swf){
$(af.application).append("<script>"+swf+"</script>");
_18();
});
}else{
_18();
}
function _18(){
var _19=window[_14.namespace].properties.width;
var _1a=window[_14.namespace].properties.width;
var _1b=window[_14.namespace].properties.color;
$(af.application).append("<div id=\"panels_loading\"><canvas style=\"overflow: hidden;\" id=\"canvas_loading\" width=\""+_19+"\" height=\""+_1a+"\"></canvas></div>");
$("*").css({"margin":"0","padding":"0"});
$("html,body").css({"height":"100%","width":"100%","background-color":_1b,"margin":"0 auto"});
$("#canvas_loading").css({"width":"100%","display":"block"});
$("#panels_loading").css({"width":"100%","background":_1b,"z-index":"0","position":"absolute","left":"0%","margin":"0 auto"});
_12=document.getElementById("canvas_loading");
_11=new createjs.Stage(_12);
createjs.Ticker.setFPS(window[_14.namespace].properties.fps);
createjs.Ticker.addEventListener("tick",_21);
_22(function(){
var _1c=new window[_14.namespace][_14.name]();
_14.elem=_1c;
_11.addChild(_1c);
_1d();
_13=_1c[_14.progress[0].name];
_13.gotoAndStop(0);
_17();
});
};
};
var _1e=function(_1f){
_13.gotoAndStop(_1f);
};
var _20=function(){
createjs.Ticker.removeEventListener("tick",_21);
$("#panels_loading").css({"display":"none"});
_12=null;
_11=null;
};
var _22=function(_23){
images=images||{};
var _24=new createjs.LoadQueue(false);
_24.addEventListener("fileload",_25);
_24.addEventListener("complete",_23);
if(window[_14.namespace].properties.manifest.length>0){
_24.loadManifest(window[_14.namespace].properties.manifest);
}else{
_23();
}
};
var _25=function(evt){
if(evt.item.type=="image"){
images[evt.item.id]=evt.result;
}
};
var _21=function(){
_11.update();
};
var _1d=function(){
var _26=window.innerWidth;
var _27=window.innerHeight;
var _28=window[_14.namespace].properties.width;
var _29=_28/_26*_27;
_12.height=_29;
var _2a=_14.elem;
for(var arg in _14.position){
var _2b=_14.position[arg];
var _2c=_2a[_2b.name];
var _2d=_2c.__proto__.nominalBounds.width;
var _2e=_2c.__proto__.nominalBounds.height;
_2c.regX=0;
_2c.regY=0;
switch(_2b.scale){
case "cover":
if(_2d/_2e>_28/_29){
_2c.scaleX=_2c.scaleY=_29/_2e;
var _2f=_2d*(_29/_2e);
_2c.x=-(_2f-_28)*0.5;
_2c.y=0;
_2e=_29;
}else{
_2c.scaleY=_2c.scaleX=_28/_2d;
var _30=_2e*(_28/_2d);
_2c.y=-(_30-_29)*0.5;
_2c.x=0;
_2d=_28;
}
break;
case "contain":
break;
case "no":
var _31=_2d/(_26/_28);
var _32=_2e/(_26/_28);
_2c.scaleX=_2c.scaleY=_31/_2d;
_2d=_31;
_2e=_32;
break;
case "scale":
default:
break;
}
if(_2b.left){
_2c.x=parseInt(_2b.left);
}else{
if(_2b.center){
_2c.x=(_28-_2d)*0.5+parseInt(_2b.center);
}else{
if(_2b.right){
_2c.x=_28-_2d-parseInt(_2b.right);
}
}
}
if(_2b.top){
_2c.y=parseInt(_2b.top);
}else{
if(_2b.middle){
_2c.y=(_29-_2e)*0.5+parseInt(_2b.middle);
}else{
if(_2b.bottom){
_2c.y=_29-_2e-parseInt(_2b.bottom);
}
}
}
}
};
return {execute:_15,progress:_1e,destory:_20};
})();
var afDirective=(function(){
var _1=function(_2){
var _3={};
_4(_3,_2);
return _3;
};
var _4=function(_5,_6){
var _7={};
var _8=_6.attributes;
for(var i=0;i<_8.length;i++){
var a=_8[i];
_7[a.nodeName.toLowerCase()]=a.value;
}
var _9=_6.children;
for(var i=0;i<_9.length;i++){
var _a=_9[i];
_4(_7,_a);
}
if(_6.nodeName.toLowerCase()=="code"){
_7.script=_6.textContent;
}
if(_5[_6.nodeName.toLowerCase()]==null){
_5[_6.nodeName.toLowerCase()]=[];
}
_5[_6.nodeName.toLowerCase()].push(_7);
};
return {getDom:_1};
})();
var afPlug=(function(){
var _1;
var _2;
var _3;
var _4;
var _5;
var _6={"explain":[],"progress":[],"action":[],"updateView":[]};
var _7=function(_8,_9){
_1=[];
for(var n in _8[0]){
_1.push(n);
}
_2=_9;
_3=0;
_5={};
if(_1.length<=0){
_2();
return;
}
_a(_b);
};
var _b=function(){
if(_3==_1.length){
_c();
return;
}
afJsLoad.load(_d(_3),function(_e,_f){
$(af.application).append("<script>(function(){var module=afPlug.getPublic('"+_1[_3]+"');"+_f+"})()</script>");
_3++;
_b();
});
};
var _c=function(){
var _10=[];
for(var _11 in _5){
var _12=_5[_11];
for(var _13 in _12.depends){
var _14=_12.depends[_13];
if("http"==_14.slice(0,4)){
_10.push(_14);
}else{
_10.push(_4+_11+"/"+_14);
}
}
}
var _15=_10.length;
var _16=0;
_17();
function _17(){
if(_16==_15){
_19();
return;
}
afJsLoad.load(_10[_16],function(err,_18){
$(af.application).append("<script>"+_18+"</script>");
_16++;
_17();
});
};
};
var _19=function(){
var _1a=[];
for(var _1b in _5){
_1a=_1a.concat(_4+_1b+"/"+_5[_1b].exports);
}
var _1c=_1a.length;
var _1d=0;
_1e();
function _1e(){
if(_1d==_1c){
_2();
return;
}
afJsLoad.load(_1a[_1d],function(err,_1f){
$(af.application).append("<script>"+_1f+"</script>");
_1d++;
_1e();
});
};
};
var _20=function(_21){
return _5[_21]||(_5[_21]={});
};
var _a=function(_22){
_4="plug/";
afJsLoad.load(_d(_3),function(err,_23){
if(err){
_4="../plug/";
afJsLoad.load(_d(_3),function(err,_24){
if(err){
_4="../../plug/";
afJsLoad.load(_d(_3),function(err,_25){
if(err){
af.error("Ê≤°ÊúâÂåπÈÖçÁö? Êèí‰ª∂ÔºåËØ∑ Ê£?Êü•Êèí‰ª∂Ë∑ØÂæ?");
}else{
_22();
}
});
}else{
_22();
}
});
}else{
_22();
}
});
};
var _d=function(_26){
return _4+_1[_26]+"/public.js";
};
var _27=function(_28,_29,_2a){
_6.progress.push({"create":_28,"progress":_29,"remove":_2a});
};
var _2b=function(_2c){
_6.explain.push(_2c);
};
var _2d=function(_2e,_2f){
_6.action.push({"type":_2e,"handler":_2f});
};
var _30=function(_31){
_6.updateView.push(_31);
};
var _32=function(){
for(var n in _6.explain){
_6.explain[n]();
}
};
var _33=function(_34,_35,evt){
for(var n in _6.action){
var _36=_6.action[n];
if(_36.type==_35){
_36.handler(_34,evt);
}
}
};
var _37=function(){
for(var n in _6.updateView){
_6.updateView[n]();
}
};
var _38=function(){
if(_6.progress.length<=0){
return null;
}
for(var n in _6.progress){
_6.progress[n].create();
}
return {};
};
var _39=function(_3a){
for(var n in _6.progress){
_6.progress[n].progress(_3a);
}
};
var _3b=function(){
for(var n in _6.progress){
_6.progress[n].remove();
}
};
var _3c=function(_3d,evt){
afAction.dispatch(_3d,evt);
};
var _3e=function(_3f,_40,_41,evt){
var _42=af.s(_3f);
var _43=_42.a(_40);
if(_43==null){
return;
}
if(null==_43[_41]){
return;
}
if(null==_42.listen){
return;
}
if(null==_42.listen[_43[_41]]){
return;
}
_42.listen[_43[_41]](evt);
};
return {load:_7,getPublic:_20,onExplain:_2b,onProgress:_27,onAction:_2d,onUpdateView:_30,executeExplain:_32,executeUpdateView:_37,actionHandler:_33,createLoading:_38,progressLoading:_39,removeLoading:_3b,dispatch:_3c,trigger:_3e};
})();
var $plug=afPlug;
var afCanvas=(function($){
var _1=function(_2,_3,_4){
$(af.application).append("<div id=\"panels\"><canvas style=\"overflow: hidden;\" id=\"canvas\" width=\""+_2+"\" height=\""+_3+"\"></canvas></div>");
$("html,body").css({"height":"100%","width":"100%","background-color":"#ffffff","margin":"0 auto"});
$("#canvas").css({"width":"100%","display":"block"});
$("#panels").css({"width":"100%","background":_4,"z-index":"0","position":"absolute","left":"0%","margin":"0 auto","display":"none"});
};
var _5=function(){
$("#panels").css({"display":"block"});
};
return {init:_1,show:_5};
})(window.$);
var afJsLoad=(function(_1,$){
var _2;
var _3=function(_4,_5){
_2=_5;
var _6=new _1.LoadQueue(true);
_6.on("fileload",_7);
_6.on("error",_8);
_6.loadFile({id:_4,type:"text",src:_4});
};
var _7=function(_9){
var _a=_9.item;
var id=_a.id;
var _b=_9.result;
_2(null,_b);
};
var _8=function(_c){
_2("error");
};
return {load:_3};
})(window.createjs,window.$);
var afImgLoad=(function(_1){
var _2;
var _3;
var _4=function(_5){
_2=_5;
images=images||{};
_3=new _1.LoadQueue(false);
_3.addEventListener("fileload",_6);
_3.addEventListener("progress",_7);
_3.addEventListener("complete",_2);
if(af.swf.properties.manifest.length>0){
_3.loadManifest(af.swf.properties.manifest);
}else{
_2();
}
};
var _6=function(_8){
if(_8.item.type=="image"){
images[_8.item.id]=_8.result;
}
};
var _7=function(_9){
var _a=_9.loaded*100>>0;
afProgress.loadImage(_a);
};
return {load:_4};
})(window.createjs);
var afCode=(function($){
var _1;
var _2;
var _3=function(_4,_5){
_1=_4;
_2=_5;
af.trace(_1);
_6();
};
var _6=function(){
if(_1.length<=0){
_2();
return;
}
var _7=_1.shift();
if(_7.src){
afJsLoad.load(_7.src,function(_8,_9){
if(_8!=null){
af.error("codeÊñá‰ª∂Âä†ËΩΩÂ§±Ë¥•ÔºåÊñá‰ª∂ÂêçÂ≠óÔºö"+_7.src);
_6();
return;
}
$("#panels").append("<script>af.s('"+_7.scene+"').listen=(function($main,$scene,$element){"+_9+";"+_a(_7.scene)+"})(af.m,af.s('"+_7.scene+"'),af.s('"+_7.scene+"').element)</script>");
_6();
});
}else{
$("#panels").append("<script>af.s('"+_7.scene+"').listen=(function($main,$scene,$element){"+_7.script+";"+_a(_7.scene)+"})(af.m,af.s('"+_7.scene+"'),af.s('"+_7.scene+"').element)</script>");
_6();
}
};
var _a=function(_b){
var _c="";
_c+="var $return={};";
var _d=af.s(_b);
for(var n in _d.action){
var _e=_d.action[n];
for(var a in _e){
if(a=="next"){
continue;
}
if(a=="type"){
continue;
}
if(a=="scene"){
continue;
}
if(a=="name"){
continue;
}
if(a=="timeline"){
continue;
}
if(a=="rewind"){
continue;
}
_c+="try{$return['"+_e[a]+"']="+_e[a]+";}catch(e){$return['"+_e[a]+"']=null;}";
}
}
_c+="return $return;";
return _c;
};
return {execute:_3};
})(window.$);
var afAction=(function(_1,$){
var _2=false;
var _3=function(_4,_5,_6,_7){
if(null==_4.element[_5.name]){
return;
}
_4.element[_5.name].on(_6,function(_8){
if(af.ismode(_4.name)){
return;
}
if(null!=_4.listen&&null!=_4.listen[_5[_7]]){
_4.listen[_5[_7]](_8);
}
if(null!=_5.timeline){
var _9=_4.a("timeline",_5.timeline);
if(_9){
_9.rewind=_5.rewind;
_a(_9);
}
}else{
_a(_5);
}
});
};
var _a=function(_b,_c){
if(true==_b.lock){
return;
}
var _d=_b.next;
if(null==_d){
_b.lock=false;
return;
}
var _e=_d.length;
var _f=_c||0;
if(_e<=_f){
_b.lock=false;
return;
}
var _10=_b.rewind?_d[_e-_f-1]:_d[_f];
var _11=_10.fragment;
if(null==_11){
_b.lock=false;
_12();
return;
}
var _13=_11.length;
var _14=0;
if(_13==0||_10.skip){
_b.lock=false;
_12();
return;
}
if(_10.lock){
_b.lock=true;
}
for(var i in _11){
var _15=_11[i];
if(_15.type=="show"){
if(_15.name==null){
af.showScene(_b.scene,true);
}else{
af.showScene(_15.name,true);
}
_16();
}else{
if(_15.type=="hide"){
if(_15.name==null){
af.hideScene(_b.scene,true);
}else{
af.hideScene(_15.name,true);
}
_16();
}else{
if(_15.type=="play"){
var _17=af.s(_b.scene).element[_15.name];
if(null==_17.gotoAndStop){
_16();
continue;
}
if(_17.aftimeline==null){
_17.aftimeline=new afTimeline(_17);
}
if(_b.rewind){
_17.aftimeline.gotoAndStop(_15.end);
_17.aftimeline.rewind();
_17.aftimeline.stopAt(_15.start,function(){
_16();
});
}else{
_17.aftimeline.gotoAndStop(_15.start);
_17.aftimeline.stopAt(_15.end,function(){
_16();
});
}
}else{
if(_15.type=="loop"){
var _17=af.s(_b.scene).element[_15.name];
if(null==_17.gotoAndStop){
_16();
continue;
}
if(_17.aftimeline==null){
_17.aftimeline=new afTimeline(_17);
}
if(_b.rewind){
_17.aftimeline.rewind();
_17.aftimeline.gotoAndPlay(_15.end,_15.start);
}else{
_17.aftimeline.gotoAndPlay(_15.start,_15.end);
}
}else{
if(_15.type=="stop"){
var _17=af.s(_b.scene).element[_15.name];
if(null==_17.gotoAndStop){
_16();
continue;
}
if(_17.aftimeline==null){
_17.aftimeline=new afTimeline(_17);
}
_17.aftimeline.gotoAndStop(_15.frame);
}else{
if(_15.type=="url"){
af.asDefault(_15,"target","_self");
window.open(_15.name,_15.target);
_16();
continue;
}else{
if(_15.type=="delay"){
af.asDefault(_15,"sec","1");
setTimeout(function(){
_16();
},parseInt(_15.sec)*1000);
}else{
if(_15.type=="turn"){
afTurn.exectue(_b,_15,function(){
_16();
});
}
}
}
}
}
}
}
}
}
function _16(){
_14++;
if(_14==_13){
_12();
}
};
function _12(){
_f++;
af.trace("default");
if(_10.skip){
if(_10.toggle){
_10.skip=false;
}
if(_10.once){
_10.skip=true;
}
_a(_b,_f);
return;
}
if(_10.lock){
_b.lock=false;
}
if(_10.toggle){
af.trace("toggle");
_10.skip=!_10.skip;
}
if(_10.reback){
af.trace("reback");
_f=0;
}
if(_10.jump){
af.trace("jump");
_f++;
}
if(_10.once){
af.trace("once");
_10.skip=true;
}
if(_10.exit){
af.trace("exit");
return;
}
_a(_b,_f);
};
};
var _18=function(_19){
for(var i in _19.action){
var _1a=_19.action[i];
switch(_1a.type){
case "click":
_3(_19,_1a,"click","click");
break;
case "pressdown":
_3(_19,_1a,"mousedown","pressdown");
break;
case "pressup":
_3(_19,_1a,"pressup","pressup");
break;
}
}
afAction.dispatchOn(_19.name,"init");
};
var _1b=function(_1c,_1d,evt){
if(af.ismode(_1c)){
return;
}
var _1e=af.s(_1c).a(_1d);
if(_1e==null){
return;
}
af.trace("action:"+_1d+",scene:"+_1c+",evt:"+JSON.stringify(evt));
switch(_1d){
case "init":
afPlug.trigger(_1c,_1d,"init",evt);
break;
case "show":
afPlug.trigger(_1c,_1d,"show",evt);
break;
case "hide":
afPlug.trigger(_1c,_1d,"hide",evt);
break;
default:
afPlug.actionHandler(_1c,_1d,evt);
break;
}
_a(_1e);
};
var _1f=function(_20,evt){
var _21=[];
for(var s in af.sceneCach){
if(af.s(s).visible){
_21.push(s);
}
}
for(var n in _21){
_1b(_21[n],_20,evt);
}
};
return {execute:_18,dispatchOn:_1b,dispatch:_1f};
})(window.createjs,window.$);
var frameObject=function(_1){
var _1=_1;
var _2=0;
var _3=0;
var _4;
var _5=0;
var _6=0;
var _7;
var _8=false;
var _9=false;
var _a=function(){
if(_1==null){
return;
}
if(_9==false){
return;
}
var w;
if(_8){
w=_1.currentFrame-1;
if(w<0){
w=_1.timeline.duration-1;
}
_1.gotoAndStop(w);
}else{
w=_1.currentFrame+1;
if(w>=_1.timeline.duration){
w=0;
}
_1.gotoAndStop(w);
}
if(_2==1){
if(w==_3){
_2=0;
_1.gotoAndStop(_3);
_9=false;
_8=false;
if(_4){
_4();
}
}
}else{
if(_2==2){
if(w==_6){
_1.gotoAndStop(_5);
}
}
}
};
var _b=function(){
_8=true;
};
var _c=function(_d,_e){
_2=1;
if(null==_d){
_d=_1.timeline.duration-1;
}
if(false==isNaN(_d)){
_3=_d;
}else{
_3=_f(_1,_d);
}
if(_3==_1.currentFrame){
_2=0;
if(_e){
_e();
}
_8=false;
return;
}
_4=_e;
_9=true;
};
var _10=function(_11,_12){
_2=2;
var _13;
if(null==_11){
_11=0;
_13=_1.currentFrame;
}else{
if(false==isNaN(_11)){
_13=_5=_11;
}else{
_13=_5=_f(_1,_11);
}
}
if(null==_12){
_12=_1.timeline.duration-1;
}else{
if(false==isNaN(_12)){
_6=_12;
}else{
_6=_f(_1,_12);
}
}
_1.gotoAndStop(_13);
_9=true;
};
var _14=function(_15){
_2=0;
if(null==_15){
_15=_1.currentFrame;
}
if(false==isNaN(_15)){
_1.gotoAndStop(_15);
}else{
_1.gotoAndStop(_f(_1,_15));
}
_9=false;
_8=false;
};
var _16=function(_17,_18){
if(delayHandler!=null){
clearTimeout(_7);
}
delayHandler=_18;
_7=setTimeout(function(){
if(delayHandler){
delayHandler();
delayHandler=null;
}
},_17);
};
var _19=function(){
if(delayHandler!=null){
clearTimeout(_7);
delayHandler=null;
}
};
var _1a=function(){
return _1;
};
var _f=function(mc,_1b){
var _1c=mc.timeline.getLabels(_1b);
if(_1c.length>0){
var _1d=-1;
var len=_1c.length;
for(var i=0;i<len;i++){
if(_1c[i].label==_1b){
_1d=_1c[i].position;
console.log(_1d);
}
}
}
return _1d;
};
return {update:_a,stopAt:_c,gotoAndPlay:_10,gotoAndStop:_14,delay:_16,clearDelay:_19,rewind:_b,getDisplayObject:_1a};
};
var afTimeline=function(_1e){
var obj=new frameObject(_1e);
_1e.gotoAndStop(0);
afTimeline.lists.push(obj);
return {update:obj.update,stopAt:obj.stopAt,gotoAndPlay:obj.gotoAndPlay,gotoAndStop:obj.gotoAndStop,delay:obj.delay,clearDelay:obj.clearDelay,rewind:obj.rewind,getDisplayObject:obj.getDisplayObject};
};
afTimeline.lists=[];
afTimeline.update=function(){
for(var i=afTimeline.lists.length-1;i>=0;i--){
afTimeline.lists[i].update();
}
};
var afUtil=(function(){
function _1(){
var _2=[],_3;
var _4=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");
for(var i=0;i<_4.length;i++){
_3=_4[i].split("=");
_2.push(_3[0]);
_2[_3[0]]=_3[1];
}
return _2;
};
return {getUrlVars:_1};
})();
var af=(function(){
var _1,_2,_3;
$(document).ready(function(){
af.asBool=function(_4,_5){
_4[_5]=_4[_5]!=null;
};
af.asDefault=function(_6,_7,_8){
if(_6[_7]==null){
_6[_7]=_8;
}
};
af.trace=function(_9){
if(af.m.debug){
console.log(JSON.stringify(_9));
}
};
af.error=function(_a){
if(af.m.debug){
throw new Error(_a);
}
};
af.alert=function(_b){
if(af.m.debug){
alert(JSON.stringify(_b));
}
};
if(null!=document.getElementById("af")){
_1=afDirective.getDom(document.getElementById("af"));
af.m=_1.div[0];
af.application="#af";
}else{
_1=afDirective.getDom(document.body);
af.m=_1.body[0];
af.application="body";
}
af.asBool(af.m,"debug");
af.asDefault(af.m,"namespace","lib");
af.asDefault(af.m,"plug",[]);
af.asDefault(af.m,"entrance",af.m.scene[0].name);
af.sceneCach={};
for(var i in af.m.scene){
var _c=af.m.scene[i];
af.sceneCach[_c.name]=i;
for(var j in _c.position){
af.asDefault(_c.position[j],"scale","scale");
af.asDefault(_c.position[j],"scene",_c.name);
}
for(var j in _c.action){
var _d=_c.action[j];
af.asDefault(_d,"scene",_c.name);
af.asBool(_d,"rewind");
af.asBool(_d,"lock");
for(var m in _d.next){
var _e=_d.next[m];
af.asBool(_e,"skip");
af.asBool(_e,"lock");
af.asBool(_e,"once");
af.asBool(_e,"toggle");
af.asBool(_e,"jump");
af.asBool(_e,"exit");
af.asBool(_e,"reback");
af.asBool(_e,"prev");
af.asBool(_e,"double");
}
}
for(var j in _c.code){
af.asDefault(_c.code[j],"scene",_c.name);
}
af.asBool(_c,"checked");
af.asBool(_c,"visible");
af.asBool(_c,"mode");
}
af.s=function(_f){
if(_f==null){
return af.m.scene;
}
var _10=af.m.scene[af.sceneCach[_f]];
if(null==_10.p){
_10.p=function(_11){
var _12=_10.position;
for(var p in _12){
if(_12[p].name==_11){
return _12[p];
}
}
throw new Error("‰∏çÂ≠òÂú®ÁöÑËÆøÈóÆÂØπË±°positionÔº?"+_11);
};
}
if(null==_10.a){
_10.a=function(_13,_14){
var _15=_10.action;
if(null==_14){
for(var a in _15){
if(_15[a].type==_13){
return _15[a];
}
}
}else{
for(var a in _15){
if(_15[a].type==_13&&_15[a].name==_14){
return _15[a];
}
}
}
return null;
};
}
return _10;
};
if(af.m.debug){
var s=$(af.application).html();
$(af.application).html("");
$(af.application).html("<div style='display:none'>"+s+"</div>");
}else{
$(af.application).html("");
}
af.modeViewIndexDictionary={};
af.modeViewList=[];
af.ismode=function(_16){
if(null==_16){
return af.modeViewList.length>0;
}
if(af.modeViewList.length>0){
return af.modeViewIndexDictionary[_16]==null;
}else{
return false;
}
};
af.trace(_1);
afProgress.execute(function(){
if(af.m.swf){
afJsLoad.load(af.m.swf,_17);
}else{
_18();
}
});
});
var _17=function(_19,swf){
afProgress.completeSWF();
if(_19!=null){
afLog.trace("swfÊñá‰ª∂Âä†ËΩΩÂ§±Ë¥•");
return;
}
$(af.application).append("<script>"+swf+"</script>");
_18();
};
var _18=function(){
af.swf=window[af.m.namespace];
for(var arg in af.swf.properties){
af.m[arg]=af.swf.properties[arg];
}
afCanvas.init(af.m.width,af.m.height,af.m.color);
af.canvas=_2=document.getElementById("canvas");
af.stage=_3=new createjs.Stage(_2);
createjs.Ticker.setFPS(af.m.fps);
createjs.Ticker.addEventListener("tick",_1a);
afPlug.load(af.m.plug,_1b);
};
var _1b=function(){
afProgress.completePlug();
afImgLoad.load(_1c);
};
var _1c=function(){
af.trace("images load complete!");
afProgress.completeImage();
_1d();
_1e();
};
var _1d=function(){
for(var _1f in af.sceneCach){
var _20=af.m.scene[af.sceneCach[_1f]];
var _21=new af.swf[_1f]();
af.asDefault(_20,"element",_21);
}
afPlug.executeExplain();
var _22=[];
for(var _1f in af.sceneCach){
var _20=af.m.scene[af.sceneCach[_1f]];
if(null==_20.code){
continue;
}
_22=_22.concat(_20.code);
}
afCode.execute(_22,_23);
};
var _1e=function(){
var _24;
var _25;
var _26=window.innerWidth;
var _27=window.innerHeight;
window.onresize=function(){
if(_24!=null){
_25=true;
return;
}
_28();
_25=false;
_24=setTimeout(function(){
if(_25&&(_26!=window.innerWidth||_27!=window.innerHeight)){
_28();
}
_24=null;
_25=false;
},1000);
};
};
var _23=function(){
for(var _29 in af.sceneCach){
afAction.execute(af.m.scene[af.sceneCach[_29]]);
}
afProgress.completeAf(function(){
_2a(af.m.entrance,true);
_28();
afCanvas.show();
af.trace("web complete!");
});
};
var _1a=function(){
afTimeline.update();
_3.update();
};
var _2a=function(_2b,_2c,_2d){
var s=af.s(_2b);
if(s.visible){
return;
}
s.visible=true;
if(s.mode&&null==af.modeViewIndexDictionary[_2b]){
af.modeViewList.push(_2b);
af.modeViewIndexDictionary[_2b]=af.modeViewList.length-1;
}
if(_2d=="before"){
_3.addChildAt(s.element,0);
}else{
_3.addChild(s.element);
}
if(_2c){
afAction.dispatchOn(_2b,"show");
}
};
var _2e=function(_2f,_30){
var s=af.s(_2f);
if(false==s.visible){
return;
}
s.visible=false;
if(s.mode&&null!=af.modeViewIndexDictionary[_2f]){
af.modeViewList.splice(af.modeViewIndexDictionary[_2f],1);
af.modeViewIndexDictionary[_2f]=null;
delete af.modeViewIndexDictionary[_2f];
}
_3.removeChild(s.element);
if(_30){
afAction.dispatchOn(_2f,"hide");
}
};
var _28=function(){
var _31=window.innerWidth;
var _32=window.innerHeight;
var _33=(window.innerWidth>window.innerHeight)?"landscape":"portrait";
var _34=af.m.width;
var _35=af.m.width/_31*_32;
_2.height=_35;
af.screenWidth=_31;
af.screenHeight=_32;
af.canvasWidth=_34;
af.canvasHeight=_35;
afPlug.executeUpdateView();
for(var _36 in af.sceneCach){
var _37=af.m.scene[af.sceneCach[_36]];
var _38=_37.element;
if(null!=_37.orient){
_37.orient==_33?af.showScene(_36):af.hideScene(_36);
}
for(var arg in _37.position){
var _39=_37.position[arg];
var _3a=_38[_39.name];
var _3b=_3a.__proto__.nominalBounds.width;
var _3c=_3a.__proto__.nominalBounds.height;
switch(_39.scale){
case "cover":
if(_3b/_3c>_34/_35){
_3a.scaleX=_3a.scaleY=_35/_3c;
var _3d=_3b*(_35/_3c);
_3a.x=-(_3d-_34)*0.5;
_3a.y=0;
_3c=_35;
}else{
_3a.scaleY=_3a.scaleX=_34/_3b;
var _3e=_3c*(_34/_3b);
_3a.y=-(_3e-_35)*0.5;
_3a.x=0;
_3b=_34;
}
break;
case "contain":
break;
case "no":
var _3f=_3b/(_31/_34);
var _40=_3c/(_31/_34);
_3a.scaleX=_3a.scaleY=_3f/_3b;
_3b=_3f;
_3c=_40;
break;
case "scale":
break;
default:
continue;
}
if(_39.left){
_3a.x=parseInt(_39.left);
}else{
if(_39.center){
_3a.x=_34*0.5+parseInt(_39.center);
}else{
if(_39.right){
_3a.x=_34-parseInt(_39.right);
}
}
}
if(_39.top){
_3a.y=parseInt(_39.top);
}else{
if(_39.middle){
_3a.y=_35*0.5+parseInt(_39.middle);
}else{
if(_39.bottom){
_3a.y=_35-parseInt(_39.bottom);
}
}
}
}
}
af.trace("view update!"+new Date().getTime());
};
var gm=function(_41){
return this[_41];
};
return {showScene:_2a,hideScene:_2e,updateView:_28,gm:gm};
})("author:zhangpeng","qq:307285468","site:www.iduizhan.com","version:0.1");

